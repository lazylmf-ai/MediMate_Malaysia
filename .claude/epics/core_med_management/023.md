---
name: Cultural Intelligence Integration
status: open
created: 2025-09-11T02:09:59Z
updated: 2025-09-11T02:09:59Z
github: https://github.com/lazylmf-ai/MediMate_Malaysia/issues/23
depends_on: [021]
parallel: true
conflicts_with: []
---

# Task 003: Cultural Intelligence Integration

## Overview
Implement comprehensive cultural intelligence features including prayer time scheduling integration, festival calendar awareness, multi-language interface support, and a cultural scheduling engine that adapts to Malaysian cultural practices and religious observances.

## Scope
- Prayer time scheduling integration with medication reminders
- Festival calendar awareness for major Malaysian celebrations
- Multi-language interface (Bahasa Malaysia, English, Chinese, Tamil)
- Cultural scheduling engine with intelligent adaptations
- Religious and cultural preference management

## Acceptance Criteria

### 1. Prayer Time Integration
- [ ] Integration with Islamic prayer time calculations for Malaysian locations
- [ ] Automatic prayer time detection based on user location
- [ ] Medication scheduling around prayer times with configurable buffers
- [ ] Different madhab support (Shafi'i primarily, Hanafi secondary)
- [ ] Qibla direction integration for prayer-related features

### 2. Festival Calendar Awareness
- [ ] Malaysian public holidays and cultural festivals integration
- [ ] Islamic calendar (Ramadan, Eid, religious observances)
- [ ] Chinese calendar (Chinese New Year, Mid-Autumn, etc.)
- [ ] Hindu calendar (Deepavali, Thaipusam, etc.)
- [ ] Automatic medication schedule adjustments during festivals
- [ ] Fasting-aware medication scheduling (Ramadan, Chinese traditions)

### 3. Multi-Language Interface
- [ ] Complete localization for Bahasa Malaysia, English, Chinese (Simplified), Tamil
- [ ] Dynamic language switching without app restart
- [ ] Cultural-appropriate UI patterns and navigation
- [ ] Right-to-left text support where applicable
- [ ] Cultural color schemes and iconography

### 4. Cultural Scheduling Engine
- [ ] Intelligent medication timing based on cultural practices
- [ ] Meal time awareness (Malaysian breakfast/lunch/dinner patterns)
- [ ] Traditional medicine integration consideration
- [ ] Family structure consideration (elderly care, children)
- [ ] Cultural dietary restrictions and medication interactions

### 5. Preference Management
- [ ] Comprehensive cultural preference setup wizard
- [ ] Granular control over cultural features
- [ ] Cultural profile inheritance for family members
- [ ] Location-based cultural defaults
- [ ] Privacy controls for cultural data

## Technical Implementation

### Technology Stack
```typescript
// Additional Dependencies for Task 003
"react-native-localize": "^3.0.0"
"i18n-js": "^4.3.0"
"date-fns": "^2.30.0"
"date-fns-tz": "^2.0.0"
"hijri-converter": "^2.0.0"
"lunar-calendar": "^1.2.0"
"react-native-vector-icons": "^10.0.0"
"react-native-permissions": "^3.8.0"
"@react-native-async-storage/async-storage": "^1.19.0"
```

### Cultural Data Models
```typescript
interface CulturalProfile {
  id: string;
  userId: string;
  primaryCulture: 'malay' | 'chinese' | 'indian' | 'mixed';
  religion: 'islam' | 'buddhism' | 'hinduism' | 'christianity' | 'none' | 'other';
  languages: Array<{
    code: 'ms' | 'en' | 'zh' | 'ta';
    proficiency: 'native' | 'fluent' | 'intermediate' | 'basic';
    primary: boolean;
  }>;
  location: {
    state: string;
    city: string;
    timezone: string;
    coordinates?: { lat: number; lng: number };
  };
  preferences: CulturalPreferences;
}

interface CulturalPreferences {
  prayerTimes: {
    enabled: boolean;
    madhab: 'shafi' | 'hanafi';
    notifications: boolean;
    medicationBuffer: number; // minutes before/after prayer
    adjustments: {
      fajr: number;
      dhuhr: number;
      asr: number;
      maghrib: number;
      isha: number;
    };
  };
  festivals: {
    islamic: { enabled: boolean; medicationAdjustments: boolean };
    chinese: { enabled: boolean; medicationAdjustments: boolean };
    hindu: { enabled: boolean; medicationAdjustments: boolean };
    malaysian: { enabled: boolean; medicationAdjustments: boolean };
  };
  dietary: {
    halal: boolean;
    vegetarian: boolean;
    traditional: string[]; // Traditional dietary practices
    restrictions: string[];
  };
  family: {
    elderlyMembers: number;
    children: Array<{ age: number; culturalConsiderations: string[] }>;
    primaryCaregiver: boolean;
    householdLanguage: 'ms' | 'en' | 'zh' | 'ta';
  };
}

interface CulturalEvent {
  id: string;
  name: string;
  type: 'religious' | 'cultural' | 'public_holiday';
  culture: 'malay' | 'chinese' | 'indian' | 'malaysian';
  date: string;
  isLunar: boolean;
  duration: number; // days
  medicationConsiderations: {
    fastingRequired: boolean;
    dietaryRestrictions: string[];
    schedulingGuidance: string;
  };
}
```

### Prayer Time Service
```typescript
class PrayerTimeService {
  async calculatePrayerTimes(
    location: { lat: number; lng: number },
    date: Date,
    madhab: 'shafi' | 'hanafi' = 'shafi'
  ): Promise<PrayerTimes> {
    // Calculate prayer times for Malaysian locations
    // Support both Shafi'i and Hanafi calculations
    // Return prayer times with local timezone
  }

  async getMedicationSchedulingWindows(
    prayerTimes: PrayerTimes,
    bufferMinutes: number = 30
  ): Promise<SchedulingWindow[]> {
    // Calculate optimal medication timing windows
    // Avoid prayer times with configurable buffers
    // Return available scheduling slots
  }
}

interface PrayerTimes {
  fajr: Date;
  dhuhr: Date;
  asr: Date;
  maghrib: Date;
  isha: Date;
  qibla: number; // degrees from north
}
```

### Cultural Calendar Service
```typescript
class CulturalCalendarService {
  async getUpcomingEvents(
    profile: CulturalProfile,
    daysAhead: number = 30
  ): Promise<CulturalEvent[]> {
    // Get relevant cultural events based on user profile
    // Include Islamic, Chinese, Hindu, and Malaysian events
    // Calculate lunar calendar dates accurately
  }

  async checkMedicationConflicts(
    medicationSchedule: MedicationSchedule,
    events: CulturalEvent[]
  ): Promise<ConflictAlert[]> {
    // Check for medication conflicts during cultural events
    // Identify fasting periods and dietary restrictions
    // Suggest schedule adjustments
  }
}
```

### Localization Service
```typescript
class LocalizationService {
  private translations: Record<string, Record<string, string>> = {};

  async initialize(profile: CulturalProfile): Promise<void> {
    // Load appropriate language packs
    // Set cultural formatting preferences
    // Configure date/time display patterns
  }

  translate(key: string, params?: Record<string, any>): string {
    // Return culturally-appropriate translations
    // Handle pluralization rules for different languages
    // Support cultural context in translations
  }

  formatCulturalDate(date: Date, culture: string): string {
    // Format dates according to cultural preferences
    // Include lunar calendar dates when relevant
    // Show appropriate calendar systems
  }
}
```

### API Integration
Leverage existing backend endpoints:
- `GET /cultural/settings` - Get cultural preferences
- `PUT /cultural/settings` - Update cultural preferences
- `GET /cultural/events` - Get cultural calendar events
- `GET /prayer-times` - Get prayer times for location
- `GET /localization/{language}` - Get language packs

## Implementation Approach

### Phase 1: Prayer Time Integration (Day 1)
1. Implement prayer time calculation for Malaysian locations
2. Create prayer time notification system
3. Develop medication scheduling integration with prayer times
4. Add Qibla direction calculation

### Phase 2: Festival Calendar (Day 2)
1. Build cultural calendar with Islamic, Chinese, Hindu events
2. Implement lunar calendar calculations
3. Create festival-aware medication scheduling
4. Add Ramadan and fasting period handling

### Phase 3: Multi-Language Interface (Day 3)
1. Set up comprehensive localization framework
2. Implement dynamic language switching
3. Create culturally-appropriate UI components
4. Add support for all four target languages

### Phase 4: Cultural Scheduling Engine (Day 4)
1. Develop intelligent scheduling algorithms
2. Implement meal time and cultural practice awareness
3. Create family structure consideration logic
4. Add traditional medicine integration awareness

## Dependencies
- Task 001: Mobile App Foundation & Authentication (required)
- Backend cultural settings API (existing)
- Location services for prayer time calculation
- Cultural calendar data sources

## Testing Strategy
- Unit tests for prayer time calculations and cultural algorithms
- Localization testing for all supported languages
- Cultural accuracy validation with community members
- Integration testing with medication scheduling
- Accessibility testing for different cultural UI patterns

## Effort Estimation
**Size: M (3-4 days)**
- Day 1: Prayer time integration and calculation
- Day 2: Festival calendar and cultural events
- Day 3: Multi-language interface implementation
- Day 4: Cultural scheduling engine and integration

## Risks & Mitigation
- **Cultural accuracy**: Validate with Malaysian cultural communities
- **Prayer time precision**: Use established Islamic calculation methods
- **Calendar complexity**: Leverage proven lunar calendar libraries
- **Localization quality**: Professional translation review for critical content
- **Performance**: Optimize cultural calculations for mobile devices

## Success Metrics
- Accurate prayer times for all Malaysian states
- Complete localization in all four target languages
- Cultural event calendar 99% accuracy
- Successful medication scheduling integration
- User satisfaction with cultural features >90%

## Cultural Considerations
- Respect for religious practices and timing
- Accuracy in Islamic, Chinese, and Hindu calendar calculations
- Appropriate cultural iconography and color schemes
- Privacy protection for cultural and religious data
- Inclusive design for Malaysia's multicultural society

## Integration Points
- **Task 002**: Medication scheduling with cultural awareness
- **Backend APIs**: Cultural settings and event calendar
- **Location Services**: Prayer time and cultural event calculation
- **Notification System**: Culturally-appropriate reminders

## Notes
- Prioritize accuracy and cultural sensitivity over feature richness
- Engage Malaysian cultural communities for validation
- Consider regional variations within Malaysia
- Build flexible system to support additional cultures in future
- Ensure offline functionality for prayer times and basic cultural features
- Focus on family-oriented healthcare culture in Malaysia