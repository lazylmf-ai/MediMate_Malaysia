---
name: Week 1 - Critical Bug Fixes & Navigation Wiring
epic: mvp_beta_readiness
status: backlog
priority: P0
created: 2025-10-04T12:24:43Z
github: https://github.com/lazylmf-ai/MediMate_Malaysia/issues/43
effort: 5 days
assignee: Wiring Squad (2 developers)
---

# Issue #42: Week 1 - Critical Bug Fixes & Navigation Wiring

**Epic:** MVP Beta Readiness
**Priority:** P0 - Critical
**Timeline:** Days 1-5 (Week 1)
**Budget:** RM 60K

## Overview

Fix critical production-blocking bugs and wire core navigation flows to make existing screens accessible to users. This is the foundation that unblocks all subsequent work.

## Problem Statement

**Current State:**
- Redis import error crashes medication service
- MedicationsScreen and FamilyScreen are placeholders
- Fully-built screens exist but aren't in navigation
- Missing 4 shared UI components

**Desired State:**
- 0 critical bugs
- All core screens accessible via navigation
- Shared components available for reuse
- End-to-end medication and family flows working

## Acceptance Criteria

### Day 1-2: Backend Stability
- [ ] Fix Redis import error in `MedicationService.ts:9`
- [ ] Remove mock data from medication APIs (5 endpoints)
- [ ] Remove mock data from family APIs (3 endpoints)
- [ ] Regression test suite passes
- [ ] No console errors on backend startup

### Day 3-4: Navigation Wiring
- [ ] Replace `MedicationsScreen.tsx` placeholder with medication list
- [ ] Replace `FamilyScreen.tsx` placeholder with `CaregiverDashboard`
- [ ] Create `MedicationsNavigator` stack
- [ ] Create `FamilyNavigator` stack
- [ ] Deep linking works for all screens

### Day 5: Missing Components
- [ ] Build `SearchableDropdown` component
- [ ] Build `ValidationMessage` component
- [ ] Build `ProgressIndicator` component
- [ ] Build `CulturalNote` component
- [ ] All components have unit tests
- [ ] Storybook entries created

## Technical Specification

### Backend Fixes

**File:** `backend/src/services/medication/MedicationService.ts:9`

```typescript
// BEFORE (broken):
import { CacheService } from '../cache/redisService';

// AFTER (fixed):
import { RedisService as CacheService } from '../cache/redisService';
```

**Affected APIs:**
```
POST   /api/medications
GET    /api/medications/:id
PUT    /api/medications/:id
DELETE /api/medications/:id
GET    /api/medications/user/:userId

GET    /api/family/:familyId/members
POST   /api/family/:familyId/invite
GET    /api/family/:familyId/adherence
```

### Navigation Architecture

**File:** `frontend/src/navigation/MedicationsNavigator.tsx` (new file)

```typescript
import { createStackNavigator } from '@react-navigation/stack';
import MedicationListScreen from '../screens/medication/MedicationListScreen';
import MedicationEntryScreen from '../screens/medication/MedicationEntryScreen';
import MedicationDetailScreen from '../screens/medication/MedicationDetailScreen';

const Stack = createStackNavigator();

export default function MedicationsNavigator() {
  return (
    <Stack.Navigator>
      <Stack.Screen name="MedicationList" component={MedicationListScreen} />
      <Stack.Screen name="MedicationEntry" component={MedicationEntryScreen} />
      <Stack.Screen name="MedicationDetail" component={MedicationDetailScreen} />
    </Stack.Navigator>
  );
}
```

**File:** `frontend/src/navigation/FamilyNavigator.tsx` (new file)

```typescript
import { createStackNavigator } from '@react-navigation/stack';
import CaregiverDashboard from '../screens/family/CaregiverDashboard';
import FamilyMemberList from '../screens/family/FamilyMemberList';
import EmergencyContactManagement from '../screens/emergency/EmergencyContactManagement';

const Stack = createStackNavigator();

export default function FamilyNavigator() {
  return (
    <Stack.Navigator>
      <Stack.Screen name="CaregiverDashboard" component={CaregiverDashboard} />
      <Stack.Screen name="FamilyMemberList" component={FamilyMemberList} />
      <Stack.Screen name="EmergencyContacts" component={EmergencyContactManagement} />
    </Stack.Navigator>
  );
}
```

### Shared Components

**Component 1: SearchableDropdown**
```typescript
// frontend/src/components/shared/SearchableDropdown.tsx
interface SearchableDropdownProps {
  items: Array<{ id: string; label: string; }>;
  onSelect: (id: string) => void;
  placeholder?: string;
  searchPlaceholder?: string;
}

export default function SearchableDropdown({
  items, onSelect, placeholder, searchPlaceholder
}: SearchableDropdownProps) {
  // Implementation with search filter, keyboard navigation
}
```

**Component 2: ValidationMessage**
```typescript
// frontend/src/components/shared/ValidationMessage.tsx
interface ValidationMessageProps {
  message: string;
  type: 'error' | 'warning' | 'success' | 'info';
}

export default function ValidationMessage({ message, type }: ValidationMessageProps) {
  // Color-coded message with icon
}
```

**Component 3: ProgressIndicator**
```typescript
// frontend/src/components/shared/ProgressIndicator.tsx
interface ProgressIndicatorProps {
  current: number;
  total: number;
  showPercentage?: boolean;
}

export default function ProgressIndicator({ current, total, showPercentage }: ProgressIndicatorProps) {
  // Visual progress bar with cultural styling
}
```

**Component 4: CulturalNote**
```typescript
// frontend/src/components/shared/CulturalNote.tsx
interface CulturalNoteProps {
  message: string;
  culturalContext: 'prayer' | 'festival' | 'dietary' | 'general';
}

export default function CulturalNote({ message, culturalContext }: CulturalNoteProps) {
  // Culturally-styled info box with appropriate icons
}
```

## Testing Requirements

### Backend Tests
```bash
# Run medication service tests
npm test -- MedicationService.test.ts

# Run family service tests
npm test -- FamilyManagementService.test.ts

# Integration tests
npm test -- integration/medication.test.ts
```

### Frontend Tests
```bash
# Component tests
npm test -- SearchableDropdown.test.tsx
npm test -- ValidationMessage.test.tsx
npm test -- ProgressIndicator.test.tsx
npm test -- CulturalNote.test.tsx

# Navigation tests
npm test -- navigation/MedicationsNavigator.test.tsx
npm test -- navigation/FamilyNavigator.test.tsx

# E2E flow test
npm test -- e2e/medication-flow.test.tsx
```

## Definition of Done

- [ ] Redis import bug fixed and verified
- [ ] All mock data removed from APIs
- [ ] MedicationsNavigator wired and functional
- [ ] FamilyNavigator wired and functional
- [ ] 4 shared components built and tested
- [ ] MedicationEntryScreen renders without crashes
- [ ] End-to-end medication flow works (list → entry → detail)
- [ ] End-to-end family flow works (dashboard → members → emergency)
- [ ] All tests passing (backend + frontend)
- [ ] No console errors or warnings
- [ ] Code reviewed and approved
- [ ] Demo video recorded

## Dependencies

**Blockers:**
- None (can start immediately)

**Blocks:**
- Week 2: Authentication integration (needs working navigation)
- Week 3: Cultural settings (needs navigation structure)
- Week 4: Content loading (needs education navigator stable)

## Risks & Mitigation

**Risk 1: Shared components more complex than expected**
- **Probability:** Medium
- **Impact:** 1-2 day delay
- **Mitigation:** Start with minimal versions, enhance later
- **Contingency:** Inline component code if needed, refactor later

**Risk 2: Database queries missing for API mock removal**
- **Probability:** Low
- **Impact:** 1 day delay
- **Mitigation:** Database schema complete, just need SQL queries
- **Contingency:** Use ORM query builder if raw SQL complex

## Success Metrics

**Day 5 Targets:**
- [ ] 0 critical bugs (P0)
- [ ] 100% navigation accessibility (0 placeholders)
- [ ] 4/4 shared components complete
- [ ] 8/8 mock APIs converted to real data
- [ ] 100% test coverage on new code
- [ ] <5 minutes to navigate all core screens

## Resources

**Team:**
- Developer 1 (Frontend): Navigation + shared components
- Developer 2 (Backend): Bug fixes + API mock removal

**Time Allocation:**
- Backend fixes: 1.5 days
- Navigation wiring: 1.5 days
- Shared components: 2 days

**Budget Breakdown:**
- Development: RM 50K (2 devs × 5 days)
- Code review: RM 5K
- Testing: RM 5K
**Total:** RM 60K

## Deliverables

1. Fixed `MedicationService.ts` (no Redis error)
2. `MedicationsNavigator.tsx` (new file)
3. `FamilyNavigator.tsx` (new file)
4. `SearchableDropdown.tsx` (new component)
5. `ValidationMessage.tsx` (new component)
6. `ProgressIndicator.tsx` (new component)
7. `CulturalNote.tsx` (new component)
8. Updated medication APIs (8 endpoints with real data)
9. Updated family APIs (3 endpoints with real data)
10. Test suite (20+ tests)
11. Demo video (5 minutes)

## Next Steps

Upon completion:
1. Merge to main branch
2. Deploy to staging environment
3. QA smoke testing
4. Kick off Week 2: Authentication Integration
5. Update epic progress (25% → 40%)
